var App=App||{};App.main={callAPI:function(t,e,s){var n=new XMLHttpRequest,r="";return n.onreadystatechange=function(){if(200===this.status&&4===this.readyState&&(r=this.responseText),400===this.status||404===this.status||500===this.status||503===this.status||520===this.status)return r="Ops! Os Macacos do Laboratório ficaram loucos =O !!",document.querySelector(".bc-main-wrapper").innerHTML=r,!1},n.open(t,e,s),n.send(),r},callBC:function(){var t=App.main,e=t.callAPI("GET","https://api.coindesk.com/v1/bpi/currentprice.json?nocache=true",!1),s=t.callAPI("GET","https://api.blinktrade.com/api/v1/BRL/ticker?crypto_currency=BTC&nocache=true",!1),n=JSON.parse(e),r=JSON.parse(s),o=n.bpi.USD.rate_float,i=r.buy,a=r.sell;t.browser.storage.sync.set({high:r.high.toFixed(2),low:r.low.toFixed(2)},function(){}),t.browser.storage.sync.get(function(e){parseInt(i)>parseInt(e.high)&&(t.browser.notifications.create("bcm",{type:"basic",iconUrl:t.browser.extension.getURL("dist/icons/btc-icon-48.svg"),title:"BC Monitor - AO INFINITO E ALÉMM!!!",message:"Valor Atual: R$ "+i.toFixed(2)}),t.browser.notifications.clear("bcm"),t.browser.storage.sync.set({show_notification:!0,current_value:i.toFixed(2)},function(){})),parseInt(i)<=parseInt(e.btc_value)&&(!e.show_notification||parseInt(i)<parseInt(e.current_value))&&(t.browser.notifications.create("bcm",{type:"basic",iconUrl:t.browser.extension.getURL("dist/icons/btc-icon-48.svg"),title:"BC Monitor - O Preço baixou!!",message:"Bora comprar mais Bitocoins? \n Valor Atual: R$ "+i.toFixed(2)}),t.browser.notifications.clear("bcm"),t.browser.storage.sync.set({show_notification:!0,current_value:i.toFixed(2)},function(){}))});var c=[];return c.valBTC=o.toFixed(2),c.valBR=i.toFixed(2),c.val_btc_br=a.toFixed(2),c},sendToUser:function(t){var e=App.main,s=e.callBC(),n={valBTC:s.valBTC,valBR:s.valBR,val_btc_br:s.val_btc_br};"refresh"===t&&e.browser.runtime.sendMessage(n,function(t){}),e.browser.runtime.onMessage.addListener(function(t,e,s){"get"===t.message&&s(n)})},cache:function(){this.browser=chrome||browser},init:function(){var t=App.main;t.cache(),t.browser.storage.sync.set({show_notification:!1},function(){}),t.callBC(),t.sendToUser(),setInterval(function(){t.sendToUser("refresh")},3e4)}},document.addEventListener("DOMContentLoaded",App.main.init);
//# sourceMappingURL=bc-monitor-background.js.map
