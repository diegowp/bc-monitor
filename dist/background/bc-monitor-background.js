var App=App||{};App.main={callAPI:function(t,e,n){var o=new XMLHttpRequest,i="";return o.onreadystatechange=function(){if(200===this.status&&4===this.readyState&&(i=this.responseText),400===this.status||404===this.status||500===this.status||503===this.status||520===this.status)return i="Ops! Os Macacos do Laboratório ficaram loucos =O !!",document.querySelector(".bc-main-wrapper").innerHTML=i,!1},o.open(t,e,n),o.send(),i},callBC:function(){var t=App.main,e=t.callAPI("GET","https://api.coindesk.com/v1/bpi/currentprice.json?nocache=true",!1),n=t.callAPI("GET","https://api.blinktrade.com/api/v1/BRL/ticker?crypto_currency=BTC&nocache=true",!1),o=JSON.parse(e),i=JSON.parse(n),a=o.bpi.USD.rate_float,s=i.buy,c=i.sell;chrome.storage.sync.set({high:i.high.toFixed(2),low:i.low.toFixed(2)},function(){}),chrome.storage.sync.get(function(t){parseInt(s)>parseInt(t.high)&&(chrome.notifications.create("bcm",{type:"basic",iconUrl:chrome.extension.getURL("dist/icons/btc-icon-48.svg"),title:"BC Monitor - AO INFINITO E ALÉMM!!!",message:"Valor Atual: R$ "+s.toFixed(2)}),chrome.notifications.clear("bcm"),chrome.storage.sync.set({show_notification:!0},function(){})),parseInt(s)<=parseInt(t.btc_value)&&(!t.show_notification||parseInt(s)<parseInt(t.current_value))&&(chrome.notifications.create("bcm",{type:"basic",iconUrl:chrome.extension.getURL("dist/icons/btc-icon-48.svg"),title:"BC Monitor - O Preço baixou!!",message:"Bora comprar mais Bitocoins? \n Valor Atual: R$ "+s.toFixed(2)}),chrome.notifications.clear("bcm"),chrome.storage.sync.set({show_notification:!0,current_value:s.toFixed(2)},function(){}))});var r=[];return r.valBTC=a.toFixed(2),r.valBR=s.toFixed(2),r.val_btc_br=c.toFixed(2),r},sendToUser:function(t){var e=App.main.callBC(),n={valBTC:e.valBTC,valBR:e.valBR,val_btc_br:e.val_btc_br};"refresh"===t&&chrome.runtime.sendMessage(n,function(t){}),chrome.runtime.onMessage.addListener(function(t,e,o){"get"===t.message&&o(n)})},init:function(){var t=App.main;chrome.storage.sync.set({show_notification:!1},function(){}),t.callBC(),t.sendToUser(),setInterval(function(){t.sendToUser("refresh")},3e4)}},document.addEventListener("DOMContentLoaded",App.main.init);
//# sourceMappingURL=bc-monitor-background.js.map
