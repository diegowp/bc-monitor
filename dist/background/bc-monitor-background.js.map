{"version":3,"names":[],"mappings":"","sources":["bc-monitor-background.js"],"sourcesContent":["var App=App||{};App.main={callAPI:function(e,t,n){var o=new XMLHttpRequest,r=\"\";return o.onreadystatechange=function(){r=200===this.status&&4===this.readyState?this.responseText:\"Ops! Os Macacos do Laboratório ficaram loucos =O !!\"},o.open(e,t,n),o.send(),r},callBC:function(){var e=App.main,t=e.callAPI(\"GET\",\"https://api.coindesk.com/v1/bpi/currentprice.json\",!1),n=e.callAPI(\"GET\",\"https://www.mercadobitcoin.net/api/BTC/ticker/\",!1),o=JSON.parse(t),r=JSON.parse(n),s=function(e){return parseFloat(e).toFixed(2)};e.browser.storage.sync.set({high:s(r.ticker.high),low:s(r.ticker.low),dolar:o.bpi.USD.rate_float.toFixed(2),buy:s(r.ticker.buy),sell:s(r.ticker.sell)},function(){}),e.browser.storage.sync.get(function(t){parseInt(t.buy)>parseInt(t.high)&&(e.browser.notifications.create(\"bcm\",{type:\"basic\",iconUrl:e.browser.extension.getURL(\"dist/icons/btc-icon-48.svg\"),title:\"BC Monitor - AO INFINITO E ALÉMM!!!\",message:\"Valor Atual: R$ \"+t.buy}),e.browser.notifications.clear(\"bcm\"),e.browser.storage.sync.set({show_notification:!0,current_value:t.buy},function(){})),parseInt(t.buy)<=parseInt(t.btc_value)&&(!t.show_notification||parseInt(t.buy)<parseInt(t.current_value))&&(e.browser.notifications.create(\"bcm\",{type:\"basic\",iconUrl:e.browser.extension.getURL(\"dist/icons/btc-icon-48.svg\"),title:\"BC Monitor - O Preço baixou!!\",message:\"Bora comprar mais Bitocoins? \\n Valor Atual: R$ \"+t.buy}),e.browser.notifications.clear(\"bcm\"),e.browser.storage.sync.set({show_notification:!0,current_value:t.buy},function(){}))})},sendToUser:function(e){var t=App.main,n={};t.browser.storage.sync.get(function(o){n={valMax:o.high,valBTC:o.dolar,valBR:o.buy,valSell:o.sell},\"refresh\"===e&&t.browser.runtime.sendMessage(n,function(e){})}),t.browser.runtime.onMessage.addListener(function(e,t,o){\"get\"===e.message&&o(n)})},cache:function(){this.browser=chrome||browser},init:function(){var e=App.main;e.cache(),e.browser.storage.sync.set({show_notification:!1},function(){}),e.callBC(),e.sendToUser(),setInterval(function(){e.callBC(),e.sendToUser(\"refresh\")},3e4)}},document.addEventListener(\"DOMContentLoaded\",App.main.init);"],"file":"bc-monitor-background.js"}